SimileAjax.version="2.2.1";SimileAjax.jQuery=jQuery.noConflict(!0);"undefined"==typeof window.$&&(window.$=SimileAjax.jQuery);SimileAjax.Platform.os={isMac:!1,isWin:!1,isWin32:!1,isUnix:!1};SimileAjax.Platform.browser={isIE:!1,isNetscape:!1,isMozilla:!1,isFirefox:!1,isOpera:!1,isSafari:!1,majorVersion:0,minorVersion:0};
(function(){var a=navigator.appName.toLowerCase(),b=navigator.userAgent.toLowerCase();SimileAjax.Platform.os.isMac=-1!=b.indexOf("mac");SimileAjax.Platform.os.isWin=-1!=b.indexOf("win");SimileAjax.Platform.os.isWin32=SimileAjax.Platform.isWin&&(-1!=b.indexOf("95")||-1!=b.indexOf("98")||-1!=b.indexOf("nt")||-1!=b.indexOf("win32")||-1!=b.indexOf("32bit"));SimileAjax.Platform.os.isUnix=-1!=b.indexOf("x11");SimileAjax.Platform.browser.isIE=-1!=a.indexOf("microsoft");SimileAjax.Platform.browser.isNetscape=
-1!=a.indexOf("netscape");SimileAjax.Platform.browser.isMozilla=-1!=b.indexOf("mozilla");SimileAjax.Platform.browser.isFirefox=-1!=b.indexOf("firefox");SimileAjax.Platform.browser.isOpera=-1!=a.indexOf("opera");SimileAjax.Platform.browser.isSafari=-1!=a.indexOf("safari");var a=function(a){a=a.split(".");SimileAjax.Platform.browser.majorVersion=parseInt(a[0]);SimileAjax.Platform.browser.minorVersion=parseInt(a[1])},c=function(a,b,c){b=a.indexOf(b,c);return 0<=b?b:a.length};if(SimileAjax.Platform.browser.isMozilla){var d=
b.indexOf("mozilla/");0<=d&&a(b.substring(d+8,c(b," ",d)))}SimileAjax.Platform.browser.isIE&&(d=b.indexOf("msie "),0<=d&&a(b.substring(d+5,c(b,";",d))));SimileAjax.Platform.browser.isNetscape&&(d=b.indexOf("rv:"),0<=d&&a(b.substring(d+3,c(b,")",d))));SimileAjax.Platform.browser.isFirefox&&(d=b.indexOf("firefox/"),0<=d&&a(b.substring(d+8,c(b," ",d))));"localeCompare"in String.prototype||(String.prototype.localeCompare=function(a){return this<a?-1:this>a?1:0})})();
SimileAjax.Platform.getDefaultLocale=function(){return SimileAjax.Platform.clientLocale};SimileAjax.Debug={silent:!1};SimileAjax.Debug.log=function(a){var b;b="console"in window&&"log"in window.console?function(a){console.log(a)}:function(a){SimileAjax.Debug.silent||alert(a)};SimileAjax.Debug.log=b;b(a)};SimileAjax.Debug.warn=function(a){var b;b="console"in window&&"warn"in window.console?function(a){console.warn(a)}:function(a){SimileAjax.Debug.silent||alert(a)};SimileAjax.Debug.warn=b;b(a)};
SimileAjax.Debug.exception=function(a,b){var c;c="throw"==SimileAjax.parseURLParameters().errors||"throw"==SimileAjax.params.errors?function(a){throw a;}:"console"in window&&"error"in window.console?function(a,b){null!=b?console.error(b+" %o",a):console.error(a);throw a;}:function(a,b){SimileAjax.Debug.silent||alert("Caught exception: "+b+"\n\nDetails: "+("description"in a?a.description:a));throw a;};SimileAjax.Debug.exception=c;c(a,b)};
SimileAjax.Debug.objectToString=function(a){return SimileAjax.Debug._objectToString(a,"")};SimileAjax.Debug._objectToString=function(a,b){var c=b+" ";if("object"==typeof a){var d="{";for(f in a)d+=c+f+": "+SimileAjax.Debug._objectToString(a[f],c)+"\n";return d+(b+"}")}if("array"==typeof a){for(var d="[",f=0;f<a.length;f++)d+=SimileAjax.Debug._objectToString(a[f],c)+"\n";return d+=b+"]"}return a};SimileAjax.XmlHttp={};
SimileAjax.XmlHttp._onReadyStateChange=function(a,b,c){switch(a.readyState){case 4:try{0==a.status||200==a.status?c&&c(a):b&&b(a.statusText,a.status,a)}catch(d){SimileAjax.Debug.exception("XmlHttp: Error handling onReadyStateChange",d)}}};
SimileAjax.XmlHttp._createRequest=function(){if(SimileAjax.Platform.browser.isIE)for(var a=["Msxml2.XMLHTTP","Microsoft.XMLHTTP","Msxml2.XMLHTTP.4.0"],b=0;b<a.length;b++)try{var c=a[b],d=function(){return new ActiveXObject(c)},f=d();SimileAjax.XmlHttp._createRequest=d;return f}catch(e){}try{return d=function(){return new XMLHttpRequest},f=d(),SimileAjax.XmlHttp._createRequest=d,f}catch(h){throw Error("Failed to create an XMLHttpRequest object");}};
SimileAjax.XmlHttp.get=function(a,b,c){var d=SimileAjax.XmlHttp._createRequest();d.open("GET",a,!0);d.onreadystatechange=function(){SimileAjax.XmlHttp._onReadyStateChange(d,b,c)};d.send(null)};SimileAjax.XmlHttp.post=function(a,b,c,d){var f=SimileAjax.XmlHttp._createRequest();f.open("POST",a,!0);f.onreadystatechange=function(){SimileAjax.XmlHttp._onReadyStateChange(f,c,d)};f.send(b)};
SimileAjax.XmlHttp._forceXML=function(a){try{a.overrideMimeType("text/xml")}catch(b){a.setrequestheader("Content-Type","text/xml")}};SimileAjax.JSON={};
(function(){var a={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},b={array:function(a){var d=["["],f,e,h,g=a.length,j;for(h=0;h<g;h+=1)if(j=a[h],e=b[typeof j])j=e(j),"string"==typeof j&&(f&&(d[d.length]=","),d[d.length]=j,f=!0);d[d.length]="]";return d.join("")},"boolean":function(a){return String(a)},"null":function(){return"null"},number:function(a){return isFinite(a)?String(a):"null"},object:function(a){if(a){if(a instanceof Array)return b.array(a);var d=["{"],f,
e,h,g;for(h in a)if(g=a[h],e=b[typeof g])g=e(g),"string"==typeof g&&(f&&(d[d.length]=","),d.push(b.string(h),":",g),f=!0);d[d.length]="}";return d.join("")}return"null"},string:function(b){/["\\\x00-\x1f]/.test(b)&&(b=b.replace(/([\x00-\x1f\\"])/g,function(b,c){var e=a[c];if(e)return e;e=c.charCodeAt();return"\\u00"+Math.floor(e/16).toString(16)+(e%16).toString(16)}));return'"'+b+'"'}};SimileAjax.JSON.toJSONString=function(a){return a instanceof Object?b.object(a):a instanceof Array?b.array(a):a.toString()};
SimileAjax.JSON.parseJSON=function(){try{return!/[^,:{}\[\]0-9.\-+Eaeflnr-u \n\r\t]/.test(this.replace(/"(\\.|[^"\\])*"/g,""))&&eval("("+this+")")}catch(a){return!1}}})();SimileAjax.DOM={};SimileAjax.DOM.registerEventWithObject=function(a,b,c,d){SimileAjax.DOM.registerEvent(a,b,function(a,b,h){return c[d].call(c,a,b,h)})};
SimileAjax.DOM.registerEvent=function(a,b,c){var d=function(b){if(b=b?b:event?event:null){var d=b.target?b.target:b.srcElement?b.srcElement:null;d&&(d=1==d.nodeType||9==d.nodeType?d:d.parentNode);return c(a,b,d)}return!0};SimileAjax.Platform.browser.isIE?a.attachEvent("on"+b,d):a.addEventListener(b,d,!1)};
SimileAjax.DOM.getPageCoordinates=function(a){var b=0,c=0;1!=a.nodeType&&(a=a.parentNode);for(var d=a;null!=d;)b+=d.offsetLeft,c+=d.offsetTop,d=d.offsetParent;for(d=document.body;null!=a&&a!=d;)a=a.parentNode;return{left:b,top:c}};SimileAjax.DOM.getSize=function(a){var b=this.getStyle(a,"width");a=this.getStyle(a,"height");-1<b.indexOf("px")&&(b=b.replace("px",""));-1<a.indexOf("px")&&(a=a.replace("px",""));return{w:b,h:a}};
SimileAjax.DOM.getStyle=function(a,b){return a.currentStyle?a.currentStyle[b]:window.getComputedStyle?document.defaultView.getComputedStyle(a,null).getPropertyValue(b):""};
SimileAjax.DOM.getEventRelativeCoordinates=function(a,b){if(SimileAjax.Platform.browser.isIE){if("mousewheel"==a.type){var c=SimileAjax.DOM.getPageCoordinates(b);return{x:a.clientX-c.left,y:a.clientY-c.top}}return{x:a.offsetX,y:a.offsetY}}c=SimileAjax.DOM.getPageCoordinates(b);return"DOMMouseScroll"==a.type&&SimileAjax.Platform.browser.isFirefox&&2==SimileAjax.Platform.browser.majorVersion?{x:a.screenX-c.left,y:a.screenY-c.top}:{x:a.pageX-c.left,y:a.pageY-c.top}};
SimileAjax.DOM.getEventPageCoordinates=function(a){if(SimileAjax.Platform.browser.isIE){var b=0,c=0;if(document.body&&(document.body.scrollLeft||document.body.scrollTop))b=document.body.scrollTop,c=document.body.scrollLeft;else if(document.documentElement&&(document.documentElement.scrollLeft||document.documentElement.scrollTop))b=document.documentElement.scrollTop,c=document.documentElement.scrollLeft;return{x:a.clientX+c,y:a.clientY+b}}return{x:a.pageX,y:a.pageY}};
SimileAjax.DOM.hittest=function(a,b,c){return SimileAjax.DOM._hittest(document.body,a,b,c)};
SimileAjax.DOM._hittest=function(a,b,c,d){var f=a.childNodes,e=0;a:for(;e<f.length;e++){for(var h=f[e],g=0;g<d.length;g++)if(h==d[g])continue a;if(0==h.offsetWidth&&0==h.offsetHeight){if(g=SimileAjax.DOM._hittest(h,b,c,d),g!=h)return g}else{for(var j=g=0,l=h;l;)g+=l.offsetTop,j+=l.offsetLeft,l=l.offsetParent;if(j<=b&&g<=c&&b-j<h.offsetWidth&&c-g<h.offsetHeight)return SimileAjax.DOM._hittest(h,b,c,d);if(1==h.nodeType&&"TR"==h.tagName&&(g=SimileAjax.DOM._hittest(h,b,c,d),g!=h))return g}}return a};
SimileAjax.DOM.cancelEvent=function(a){a.returnValue=!1;a.cancelBubble=!0;"preventDefault"in a&&a.preventDefault()};SimileAjax.DOM.appendClassName=function(a,b){for(var c=a.className.split(" "),d=0;d<c.length;d++)if(c[d]==b)return;c.push(b);a.className=c.join(" ")};SimileAjax.DOM.createInputElement=function(a){var b=document.createElement("div");b.innerHTML="<input type='"+a+"' />";return b.firstChild};
SimileAjax.DOM.createDOMFromTemplate=function(a){var b={};b.elmt=SimileAjax.DOM._createDOMFromTemplate(a,b,null);return b};
SimileAjax.DOM._createDOMFromTemplate=function(a,b,c){if(null==a)return null;if("object"!=typeof a)return a=document.createTextNode(a),null!=c&&c.appendChild(a),a;var d=null;if("tag"in a){var f=a.tag;null!=c&&("tr"==f?d=c.insertRow(c.rows.length):"td"==f&&(d=c.insertCell(c.cells.length)));null==d&&(d="input"==f?SimileAjax.DOM.createInputElement(a.type):document.createElement(f),null!=c&&c.appendChild(d))}else d=a.elmt,null!=c&&c.appendChild(d);for(var e in a)if(c=a[e],"field"==e)b[c]=d;else if("className"==
e)d.className=c;else if("id"==e)d.id=c;else if("title"==e)d.title=c;else if(!("type"==e&&"input"==d.tagName))if("style"==e)for(n in c)f=c[n],"float"==n&&(n=SimileAjax.Platform.browser.isIE?"styleFloat":"cssFloat"),d.style[n]=f;else if("children"==e)for(f=0;f<c.length;f++)SimileAjax.DOM._createDOMFromTemplate(c[f],b,d);else"tag"!=e&&"elmt"!=e&&d.setAttribute(e,c);return d};SimileAjax.DOM._cachedParent=null;
SimileAjax.DOM.createElementFromString=function(a){null==SimileAjax.DOM._cachedParent&&(SimileAjax.DOM._cachedParent=document.createElement("div"));SimileAjax.DOM._cachedParent.innerHTML=a;return SimileAjax.DOM._cachedParent.firstChild};SimileAjax.DOM.createDOMFromString=function(a,b,c){a="string"==typeof a?document.createElement(a):a;a.innerHTML=b;b={elmt:a};SimileAjax.DOM._processDOMChildrenConstructedFromString(b,a,null!=c?c:{});return b};
SimileAjax.DOM._processDOMConstructedFromString=function(a,b,c){var d=b.id;if(null!=d&&0<d.length){b.removeAttribute("id");if(d in c){var f=b.parentNode;f.insertBefore(c[d],b);f.removeChild(b);a[d]=c[d];return}a[d]=b}b.hasChildNodes()&&SimileAjax.DOM._processDOMChildrenConstructedFromString(a,b,c)};SimileAjax.DOM._processDOMChildrenConstructedFromString=function(a,b,c){for(b=b.firstChild;null!=b;){var d=b.nextSibling;1==b.nodeType&&SimileAjax.DOM._processDOMConstructedFromString(a,b,c);b=d}};
SimileAjax.Graphics={};SimileAjax.Graphics.pngIsTranslucent=!SimileAjax.Platform.browser.isIE||6<SimileAjax.Platform.browser.majorVersion;SimileAjax.Graphics.pngIsTranslucent||SimileAjax.includeCssFile(document,SimileAjax.urlPrefix+"styles/graphics-ie6.css");SimileAjax.Graphics._createTranslucentImage1=function(a,b){var c=document.createElement("img");c.setAttribute("src",a);null!=b&&(c.style.verticalAlign=b);return c};
SimileAjax.Graphics._createTranslucentImage2=function(a,b){var c=document.createElement("img");c.style.width="1px";c.style.height="1px";c.style.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+a+"', sizingMethod='image')";c.style.verticalAlign=null!=b?b:"middle";return c};SimileAjax.Graphics.createTranslucentImage=SimileAjax.Graphics.pngIsTranslucent?SimileAjax.Graphics._createTranslucentImage1:SimileAjax.Graphics._createTranslucentImage2;
SimileAjax.Graphics._createTranslucentImageHTML1=function(a,b){return'<img src="'+a+'"'+(null!=b?' style="vertical-align: '+b+';"':"")+" />"};SimileAjax.Graphics._createTranslucentImageHTML2=function(a,b){return"<img src='"+a+"' style=\""+("width: 1px; height: 1px; filter:progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+a+"', sizingMethod='image');"+(null!=b?" vertical-align: "+b+";":""))+'" />'};
SimileAjax.Graphics.createTranslucentImageHTML=SimileAjax.Graphics.pngIsTranslucent?SimileAjax.Graphics._createTranslucentImageHTML1:SimileAjax.Graphics._createTranslucentImageHTML2;SimileAjax.Graphics.setOpacity=function(a,b){if(SimileAjax.Platform.browser.isIE)a.style.filter="progid:DXImageTransform.Microsoft.Alpha(Style=0,Opacity="+b+")";else{var c=(b/100).toString();a.style.opacity=c;a.style.MozOpacity=c}};
SimileAjax.Graphics.bubbleConfig={containerCSSClass:"simileAjax-bubble-container",innerContainerCSSClass:"simileAjax-bubble-innerContainer",contentContainerCSSClass:"simileAjax-bubble-contentContainer",borderGraphicSize:50,borderGraphicCSSClassPrefix:"simileAjax-bubble-border-",arrowGraphicTargetOffset:33,arrowGraphicLength:100,arrowGraphicWidth:49,arrowGraphicCSSClassPrefix:"simileAjax-bubble-arrow-",closeGraphicCSSClass:"simileAjax-bubble-close",extraPadding:20};
SimileAjax.Graphics.createBubbleForContentAndPoint=function(a,b,c,d,f,e){"number"!=typeof d&&(d=300);"number"!=typeof e&&(e=0);a.style.position="fixed";a.style.left="-5000px";a.style.top="0px";a.style.width=d+"px";document.body.appendChild(a);window.setTimeout(function(){var d=a.scrollWidth+10,g=a.scrollHeight+10,j=0;0<e&&g>e&&(g=e,j=d-25);g=SimileAjax.Graphics.createBubbleForPoint(b,c,d,g,f);document.body.removeChild(a);a.style.position="static";a.style.left="";a.style.top="";0<j?(d=document.createElement("div"),
a.style.width="",d.style.width=j+"px",d.appendChild(a),g.content.appendChild(d)):(a.style.width=d+"px",g.content.appendChild(a))},200)};
SimileAjax.Graphics.createBubbleForPoint=function(a,b,c,d,f){c=parseInt(c,10);d=parseInt(d,10);var e=SimileAjax.Graphics.bubbleConfig,h=SimileAjax.Graphics.pngIsTranslucent?"pngTranslucent":"pngNotTranslucent",g=function(a){return a+" "+a+"-"+h},j=document.createElement("div");j.className=g(e.containerCSSClass);j.style.width=c+"px";j.style.height=d+"px";var l=document.createElement("div");l.className=g(e.innerContainerCSSClass);j.appendChild(l);var m={_closed:!1},p=SimileAjax.WindowManager.pushLayer(function(){m._closed||
(document.body.removeChild(m._div),m._doc=null,m._div=null,m._content=null,m._closed=!0)},!0,j);m._div=j;m.close=function(){SimileAjax.WindowManager.popLayer(p)};var k=function(a){var b=document.createElement("div");b.className=g(e.borderGraphicCSSClassPrefix+a);l.appendChild(b)};k("top-left");k("top-right");k("bottom-left");k("bottom-right");k("left");k("right");k("top");k("bottom");k=document.createElement("div");k.className=g(e.contentContainerCSSClass);l.appendChild(k);m.content=k;k=document.createElement("div");
k.className=g(e.closeGraphicCSSClass);l.appendChild(k);SimileAjax.WindowManager.registerEventWithObject(k,"click",m,"close");a:{var k=SimileAjax.Graphics.getWindowDimensions(),q=k.w,t=k.h,k=Math.ceil(e.arrowGraphicWidth/2),s=function(a){var b=document.createElement("div");b.className=g(e.arrowGraphicCSSClassPrefix+"point-"+a);l.appendChild(b);return b};if(0<a-k-e.borderGraphicSize-e.extraPadding&&a+k+e.borderGraphicSize+e.extraPadding<q){var r=a-Math.round(c/2),r=a<q/2?Math.max(r,e.extraPadding+e.borderGraphicSize):
Math.min(r,q-e.extraPadding-e.borderGraphicSize-c);if(f&&"top"==f||!f&&0<b-e.arrowGraphicTargetOffset-d-e.borderGraphicSize-e.extraPadding){f=s("down");f.style.left=a-k-r+"px";j.style.left=r+"px";j.style.top=b-e.arrowGraphicTargetOffset-d+"px";break a}else if(f&&"bottom"==f||!f&&b+e.arrowGraphicTargetOffset+d+e.borderGraphicSize+e.extraPadding<t){f=s("up");f.style.left=a-k-r+"px";j.style.left=r+"px";j.style.top=b+e.arrowGraphicTargetOffset+"px";break a}}q=b-Math.round(d/2);q=b<t/2?Math.max(q,e.extraPadding+
e.borderGraphicSize):Math.min(q,t-e.extraPadding-e.borderGraphicSize-d);f&&"left"==f||!f&&0<a-e.arrowGraphicTargetOffset-c-e.borderGraphicSize-e.extraPadding?(f=s("right"),f.style.top=b-k-q+"px",j.style.top=q+"px",j.style.left=a-e.arrowGraphicTargetOffset-c+"px"):(f=s("left"),f.style.top=b-k-q+"px",j.style.top=q+"px",j.style.left=a+e.arrowGraphicTargetOffset+"px")}document.body.appendChild(j);return m};
SimileAjax.Graphics.getWindowDimensions=function(){if("number"==typeof window.innerHeight)return{w:window.innerWidth,h:window.innerHeight};if(document.documentElement&&document.documentElement.clientHeight)return{w:document.documentElement.clientWidth,h:document.documentElement.clientHeight};if(document.body&&document.body.clientHeight)return{w:document.body.clientWidth,h:document.body.clientHeight}};
SimileAjax.Graphics.createMessageBubble=function(a){var b=a.createElement("div");if(SimileAjax.Graphics.pngIsTranslucent){var c=a.createElement("div");c.style.height="33px";c.style.background="url("+SimileAjax.urlPrefix+"images/message-top-left.png) top left no-repeat";c.style.paddingLeft="44px";b.appendChild(c);var d=a.createElement("div");d.style.height="33px";d.style.background="url("+SimileAjax.urlPrefix+"images/message-top-right.png) top right no-repeat";c.appendChild(d);c=a.createElement("div");
c.style.background="url("+SimileAjax.urlPrefix+"images/message-left.png) top left repeat-y";c.style.paddingLeft="44px";b.appendChild(c);d=a.createElement("div");d.style.background="url("+SimileAjax.urlPrefix+"images/message-right.png) top right repeat-y";d.style.paddingRight="44px";c.appendChild(d);c=a.createElement("div");d.appendChild(c);d=a.createElement("div");d.style.height="55px";d.style.background="url("+SimileAjax.urlPrefix+"images/message-bottom-left.png) bottom left no-repeat";d.style.paddingLeft=
"44px";b.appendChild(d);a=a.createElement("div");a.style.height="55px";a.style.background="url("+SimileAjax.urlPrefix+"images/message-bottom-right.png) bottom right no-repeat";d.appendChild(a)}else b.style.border="2px solid #7777AA",b.style.padding="20px",b.style.background="white",SimileAjax.Graphics.setOpacity(b,90),c=a.createElement("div"),b.appendChild(c);return{containerDiv:b,contentDiv:c}};
SimileAjax.Graphics.createAnimation=function(a,b,c,d,f){return new SimileAjax.Graphics._Animation(a,b,c,d,f)};SimileAjax.Graphics._Animation=function(a,b,c,d,f){this.f=a;this.cont="function"==typeof f?f:function(){};this.from=b;this.to=c;this.current=b;this.duration=d;this.start=(new Date).getTime();this.timePassed=0};SimileAjax.Graphics._Animation.prototype.run=function(){var a=this;window.setTimeout(function(){a.step()},50)};
SimileAjax.Graphics._Animation.prototype.step=function(){this.timePassed+=50;var a=(-Math.cos(this.timePassed/this.duration*Math.PI)/2+0.5)*(this.to-this.from)+this.from;try{this.f(a,a-this.current)}catch(b){}this.current=a;this.timePassed<this.duration?this.run():(this.f(this.to,0),this.cont())};
SimileAjax.Graphics.createStructuredDataCopyButton=function(a,b,c,d){var f=document.createElement("div");f.style.position="relative";f.style.display="inline";f.style.width=b+"px";f.style.height=c+"px";f.style.overflow="hidden";f.style.margin="2px";SimileAjax.Graphics.pngIsTranslucent?f.style.background="url("+a+") no-repeat":f.style.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+a+"', sizingMethod='image')";f.innerHTML="<textarea rows='1' autocomplete='off' value='none' style='"+
(SimileAjax.Platform.browser.isIE?"filter:alpha(opacity=0)":"opacity: 0")+"' />";var e=f.firstChild;e.style.width=b+"px";e.style.height=c+"px";e.onmousedown=function(a){a=a?a:event?event:null;2==a.button&&(e.value=d(),e.select())};return f};SimileAjax.Graphics.getWidthHeight=function(a){var b;null==a.getBoundingClientRect?(b=a.offsetWidth,a=a.offsetHeight):(a=a.getBoundingClientRect(),b=Math.ceil(a.right-a.left),a=Math.ceil(a.bottom-a.top));return{width:b,height:a}};
SimileAjax.Graphics.getFontRenderingContext=function(a,b){return new SimileAjax.Graphics._FontRenderingContext(a,b)};SimileAjax.Graphics._FontRenderingContext=function(a,b){this._elmt=a;this._elmt.style.visibility="hidden";"string"==typeof b?this._elmt.style.width=b:"number"==typeof b&&(this._elmt.style.width=b+"px")};SimileAjax.Graphics._FontRenderingContext.prototype.dispose=function(){this._elmt=null};
SimileAjax.Graphics._FontRenderingContext.prototype.update=function(){this._elmt.innerHTML="A";this._lineHeight=this._elmt.offsetHeight};SimileAjax.Graphics._FontRenderingContext.prototype.computeSize=function(a,b){var c=this._elmt;c.innerHTML=a;c.className=void 0===b?"":b;var d=SimileAjax.Graphics.getWidthHeight(c);c.className="";return d};SimileAjax.Graphics._FontRenderingContext.prototype.getLineHeight=function(){return this._lineHeight};SimileAjax.DateTime={};SimileAjax.DateTime.MILLISECOND=0;
SimileAjax.DateTime.SECOND=1;SimileAjax.DateTime.MINUTE=2;SimileAjax.DateTime.HOUR=3;SimileAjax.DateTime.DAY=4;SimileAjax.DateTime.WEEK=5;SimileAjax.DateTime.MONTH=6;SimileAjax.DateTime.YEAR=7;SimileAjax.DateTime.DECADE=8;SimileAjax.DateTime.CENTURY=9;SimileAjax.DateTime.MILLENNIUM=10;SimileAjax.DateTime.EPOCH=-1;SimileAjax.DateTime.ERA=-2;SimileAjax.DateTime.gregorianUnitLengths=[];
(function(){var a=SimileAjax.DateTime,b=a.gregorianUnitLengths;b[a.MILLISECOND]=1;b[a.SECOND]=1E3;b[a.MINUTE]=60*b[a.SECOND];b[a.HOUR]=60*b[a.MINUTE];b[a.DAY]=24*b[a.HOUR];b[a.WEEK]=7*b[a.DAY];b[a.MONTH]=31*b[a.DAY];b[a.YEAR]=365*b[a.DAY];b[a.DECADE]=10*b[a.YEAR];b[a.CENTURY]=100*b[a.YEAR];b[a.MILLENNIUM]=1E3*b[a.YEAR]})();SimileAjax.DateTime._dateRegexp=/^(-?)([0-9]{4})((-?([0-9]{2})(-?([0-9]{2}))?)|(-?([0-9]{3}))|(-?W([0-9]{2})(-?([1-7]))?))?$/;SimileAjax.DateTime._timezoneRegexp=/Z|(([-+])([0-9]{2})(:?([0-9]{2}))?)$/;
SimileAjax.DateTime._timeRegexp=/^([0-9]{2})(:?([0-9]{2})(:?([0-9]{2})(.([0-9]+))?)?)?$/;
SimileAjax.DateTime.setIso8601Date=function(a,b){var c=b.match(SimileAjax.DateTime._dateRegexp);if(!c)throw Error("Invalid date string: "+b);var d=c[5],f=c[7],e=c[9],h=c[11],g=c[13]?c[13]:1;a.setUTCFullYear(("-"==c[1]?-1:1)*c[2]);e?(a.setUTCMonth(0),a.setUTCDate(Number(e))):h?(a.setUTCMonth(0),a.setUTCDate(1),c=(c=a.getUTCDay())?c:7,h=Number(g)+7*Number(h),4>=c?a.setUTCDate(h+1-c):a.setUTCDate(h+8-c)):(d&&(a.setUTCDate(1),a.setUTCMonth(d-1)),f&&a.setUTCDate(f));return a};
SimileAjax.DateTime.setIso8601Time=function(a,b){var c=b.match(SimileAjax.DateTime._timeRegexp);if(!c)return SimileAjax.Debug.warn("Invalid time string: "+b),!1;var d=Number(c[3]?c[3]:0),f=c[5]?c[5]:0,e=c[7]?1E3*Number("0."+c[7]):0;a.setUTCHours(c[1]);a.setUTCMinutes(d);a.setUTCSeconds(f);a.setUTCMilliseconds(e);return a};SimileAjax.DateTime.timezoneOffset=(new Date).getTimezoneOffset();
SimileAjax.DateTime.setIso8601=function(a,b){var c=null,d=-1==b.indexOf("T")?b.split(" "):b.split("T");SimileAjax.DateTime.setIso8601Date(a,d[0]);if(2==d.length){var f=d[1].match(SimileAjax.DateTime._timezoneRegexp);f&&("Z"==f[0]?c=0:(c=60*Number(f[3])+Number(f[5]),c*="-"==f[2]?1:-1),d[1]=d[1].substr(0,d[1].length-f[0].length));SimileAjax.DateTime.setIso8601Time(a,d[1])}null==c&&(c=a.getTimezoneOffset());a.setTime(a.getTime()+6E4*c);return a};
SimileAjax.DateTime.parseIso8601DateTime=function(a){try{return SimileAjax.DateTime.setIso8601(new Date(0),a)}catch(b){return null}};SimileAjax.DateTime.parseGregorianDateTime=function(a){if(null==a)return null;if(a instanceof Date)return a;var b=a.toString();if(0<b.length&&8>b.length){var c=b.indexOf(" ");0<c?(a=parseInt(b.substr(0,c)),"bc"==b.substr(c+1).toLowerCase()&&(a=1-a)):a=parseInt(b);b=new Date(0);b.setUTCFullYear(a);return b}try{return new Date(Date.parse(b))}catch(d){return null}};
SimileAjax.DateTime.roundDownToInterval=function(a,b,c,d,f){c*=SimileAjax.DateTime.gregorianUnitLengths[SimileAjax.DateTime.HOUR];var e=new Date(a.getTime()+c),h=function(a){a.setUTCMilliseconds(0);a.setUTCSeconds(0);a.setUTCMinutes(0);a.setUTCHours(0)},g=function(a){h(a);a.setUTCDate(1);a.setUTCMonth(0)};switch(b){case SimileAjax.DateTime.MILLISECOND:b=e.getUTCMilliseconds();e.setUTCMilliseconds(b-b%d);break;case SimileAjax.DateTime.SECOND:e.setUTCMilliseconds(0);b=e.getUTCSeconds();e.setUTCSeconds(b-
b%d);break;case SimileAjax.DateTime.MINUTE:e.setUTCMilliseconds(0);e.setUTCSeconds(0);b=e.getUTCMinutes();e.setTime(e.getTime()-b%d*SimileAjax.DateTime.gregorianUnitLengths[SimileAjax.DateTime.MINUTE]);break;case SimileAjax.DateTime.HOUR:e.setUTCMilliseconds(0);e.setUTCSeconds(0);e.setUTCMinutes(0);b=e.getUTCHours();e.setUTCHours(b-b%d);break;case SimileAjax.DateTime.DAY:h(e);break;case SimileAjax.DateTime.WEEK:h(e);d=(e.getUTCDay()+7-f)%7;e.setTime(e.getTime()-d*SimileAjax.DateTime.gregorianUnitLengths[SimileAjax.DateTime.DAY]);
break;case SimileAjax.DateTime.MONTH:h(e);e.setUTCDate(1);b=e.getUTCMonth();e.setUTCMonth(b-b%d);break;case SimileAjax.DateTime.YEAR:g(e);b=e.getUTCFullYear();e.setUTCFullYear(b-b%d);break;case SimileAjax.DateTime.DECADE:g(e);e.setUTCFullYear(10*Math.floor(e.getUTCFullYear()/10));break;case SimileAjax.DateTime.CENTURY:g(e);e.setUTCFullYear(100*Math.floor(e.getUTCFullYear()/100));break;case SimileAjax.DateTime.MILLENNIUM:g(e),e.setUTCFullYear(1E3*Math.floor(e.getUTCFullYear()/1E3))}a.setTime(e.getTime()-
c)};SimileAjax.DateTime.roundUpToInterval=function(a,b,c,d,f){var e=a.getTime();SimileAjax.DateTime.roundDownToInterval(a,b,c,d,f);a.getTime()<e&&a.setTime(a.getTime()+SimileAjax.DateTime.gregorianUnitLengths[b]*d)};
SimileAjax.DateTime.incrementByInterval=function(a,b,c){c=("undefined"==typeof c?0:c)*SimileAjax.DateTime.gregorianUnitLengths[SimileAjax.DateTime.HOUR];var d=new Date(a.getTime()+c);switch(b){case SimileAjax.DateTime.MILLISECOND:d.setTime(d.getTime()+1);break;case SimileAjax.DateTime.SECOND:d.setTime(d.getTime()+1E3);break;case SimileAjax.DateTime.MINUTE:d.setTime(d.getTime()+SimileAjax.DateTime.gregorianUnitLengths[SimileAjax.DateTime.MINUTE]);break;case SimileAjax.DateTime.HOUR:d.setTime(d.getTime()+
SimileAjax.DateTime.gregorianUnitLengths[SimileAjax.DateTime.HOUR]);break;case SimileAjax.DateTime.DAY:d.setUTCDate(d.getUTCDate()+1);break;case SimileAjax.DateTime.WEEK:d.setUTCDate(d.getUTCDate()+7);break;case SimileAjax.DateTime.MONTH:d.setUTCMonth(d.getUTCMonth()+1);break;case SimileAjax.DateTime.YEAR:d.setUTCFullYear(d.getUTCFullYear()+1);break;case SimileAjax.DateTime.DECADE:d.setUTCFullYear(d.getUTCFullYear()+10);break;case SimileAjax.DateTime.CENTURY:d.setUTCFullYear(d.getUTCFullYear()+100);
break;case SimileAjax.DateTime.MILLENNIUM:d.setUTCFullYear(d.getUTCFullYear()+1E3)}a.setTime(d.getTime()-c)};SimileAjax.DateTime.removeTimeZoneOffset=function(a,b){return new Date(a.getTime()+b*SimileAjax.DateTime.gregorianUnitLengths[SimileAjax.DateTime.HOUR])};SimileAjax.DateTime.getTimezone=function(){return(new Date).getTimezoneOffset()/-60};String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")};
String.prototype.startsWith=function(a){return this.length>=a.length&&this.substr(0,a.length)==a};String.prototype.endsWith=function(a){return this.length>=a.length&&this.substr(this.length-a.length)==a};
String.substitute=function(a,b){for(var c="",d=0;d<a.length-1;){var f=a.indexOf("%",d);if(0>f||f==a.length-1)break;else if(f>d&&"\\"==a.charAt(f-1))c+=a.substring(d,f-1)+"%",d=f+1;else var e=parseInt(a.charAt(f+1)),c=isNaN(e)||e>=b.length?c+a.substring(d,f+2):c+(a.substring(d,f)+b[e].toString()),d=f+2}d<a.length&&(c+=a.substring(d));return c};SimileAjax.HTML={};SimileAjax.HTML._e2uHash={};
(function(){var a=SimileAjax.HTML._e2uHash;a.nbsp="\u00a0[space]";a.iexcl="\u00a1";a.cent="\u00a2";a.pound="\u00a3";a.curren="\u00a4";a.yen="\u00a5";a.brvbar="\u00a6";a.sect="\u00a7";a.uml="\u00a8";a.copy="\u00a9";a.ordf="\u00aa";a.laquo="\u00ab";a.not="\u00ac";a.shy="\u00ad";a.reg="\u00ae";a.macr="\u00af";a.deg="\u00b0";a.plusmn="\u00b1";a.sup2="\u00b2";a.sup3="\u00b3";a.acute="\u00b4";a.micro="\u00b5";a.para="\u00b6";a.middot="\u00b7";a.cedil="\u00b8";a.sup1="\u00b9";a.ordm="\u00ba";a.raquo="\u00bb";
a.frac14="\u00bc";a.frac12="\u00bd";a.frac34="\u00be";a.iquest="\u00bf";a.Agrave="\u00c0";a.Aacute="\u00c1";a.Acirc="\u00c2";a.Atilde="\u00c3";a.Auml="\u00c4";a.Aring="\u00c5";a.AElig="\u00c6";a.Ccedil="\u00c7";a.Egrave="\u00c8";a.Eacute="\u00c9";a.Ecirc="\u00ca";a.Euml="\u00cb";a.Igrave="\u00cc";a.Iacute="\u00cd";a.Icirc="\u00ce";a.Iuml="\u00cf";a.ETH="\u00d0";a.Ntilde="\u00d1";a.Ograve="\u00d2";a.Oacute="\u00d3";a.Ocirc="\u00d4";a.Otilde="\u00d5";a.Ouml="\u00d6";a.times="\u00d7";a.Oslash="\u00d8";
a.Ugrave="\u00d9";a.Uacute="\u00da";a.Ucirc="\u00db";a.Uuml="\u00dc";a.Yacute="\u00dd";a.THORN="\u00de";a.szlig="\u00df";a.agrave="\u00e0";a.aacute="\u00e1";a.acirc="\u00e2";a.atilde="\u00e3";a.auml="\u00e4";a.aring="\u00e5";a.aelig="\u00e6";a.ccedil="\u00e7";a.egrave="\u00e8";a.eacute="\u00e9";a.ecirc="\u00ea";a.euml="\u00eb";a.igrave="\u00ec";a.iacute="\u00ed";a.icirc="\u00ee";a.iuml="\u00ef";a.eth="\u00f0";a.ntilde="\u00f1";a.ograve="\u00f2";a.oacute="\u00f3";a.ocirc="\u00f4";a.otilde="\u00f5";
a.ouml="\u00f6";a.divide="\u00f7";a.oslash="\u00f8";a.ugrave="\u00f9";a.uacute="\u00fa";a.ucirc="\u00fb";a.uuml="\u00fc";a.yacute="\u00fd";a.thorn="\u00fe";a.yuml="\u00ff";a.quot='"';a.amp="&";a.lt="<";a.gt=">";a.OElig="";a.oelig="\u0153";a.Scaron="\u0160";a.scaron="\u0161";a.Yuml="\u0178";a.circ="\u02c6";a.tilde="\u02dc";a.ensp="\u2002";a.emsp="\u2003";a.thinsp="\u2009";a.zwnj="\u200c";a.zwj="\u200d";a.lrm="\u200e";a.rlm="\u200f";a.ndash="\u2013";a.mdash="\u2014";a.lsquo="\u2018";a.rsquo="\u2019";
a.sbquo="\u201a";a.ldquo="\u201c";a.rdquo="\u201d";a.bdquo="\u201e";a.dagger="\u2020";a.Dagger="\u2021";a.permil="\u2030";a.lsaquo="\u2039";a.rsaquo="\u203a";a.euro="\u20ac";a.fnof="\u0192";a.Alpha="\u0391";a.Beta="\u0392";a.Gamma="\u0393";a.Delta="\u0394";a.Epsilon="\u0395";a.Zeta="\u0396";a.Eta="\u0397";a.Theta="\u0398";a.Iota="\u0399";a.Kappa="\u039a";a.Lambda="\u039b";a.Mu="\u039c";a.Nu="\u039d";a.Xi="\u039e";a.Omicron="\u039f";a.Pi="\u03a0";a.Rho="\u03a1";a.Sigma="\u03a3";a.Tau="\u03a4";a.Upsilon=
"\u03a5";a.Phi="\u03a6";a.Chi="\u03a7";a.Psi="\u03a8";a.Omega="\u03a9";a.alpha="\u03b1";a.beta="\u03b2";a.gamma="\u03b3";a.delta="\u03b4";a.epsilon="\u03b5";a.zeta="\u03b6";a.eta="\u03b7";a.theta="\u03b8";a.iota="\u03b9";a.kappa="\u03ba";a.lambda="\u03bb";a.mu="\u03bc";a.nu="\u03bd";a.xi="\u03be";a.omicron="\u03bf";a.pi="\u03c0";a.rho="\u03c1";a.sigmaf="\u03c2";a.sigma="\u03c3";a.tau="\u03c4";a.upsilon="\u03c5";a.phi="\u03c6";a.chi="\u03c7";a.psi="\u03c8";a.omega="\u03c9";a.thetasym="\u03d1";a.upsih=
"\u03d2";a.piv="\u03d6";a.bull="\u2022";a.hellip="\u2026";a.prime="\u2032";a.Prime="\u2033";a.oline="\u203e";a.frasl="\u2044";a.weierp="\u2118";a.image="\u2111";a.real="\u211c";a.trade="\u2122";a.alefsym="\u2135";a.larr="\u2190";a.uarr="\u2191";a.rarr="\u2192";a.darr="\u2193";a.harr="\u2194";a.crarr="\u21b5";a.lArr="\u21d0";a.uArr="\u21d1";a.rArr="\u21d2";a.dArr="\u21d3";a.hArr="\u21d4";a.forall="\u2200";a.part="\u2202";a.exist="\u2203";a.empty="\u2205";a.nabla="\u2207";a.isin="\u2208";a.notin="\u2209";
a.ni="\u220b";a.prod="\u220f";a.sum="\u2211";a.minus="\u2212";a.lowast="\u2217";a.radic="\u221a";a.prop="\u221d";a.infin="\u221e";a.ang="\u2220";a.and="\u2227";a.or="\u2228";a.cap="\u2229";a.cup="\u222a";a["int"]="\u222b";a.there4="\u2234";a.sim="\u223c";a.cong="\u2245";a.asymp="\u2248";a.ne="\u2260";a.equiv="\u2261";a.le="\u2264";a.ge="\u2265";a.sub="\u2282";a.sup="\u2283";a.nsub="\u2284";a.sube="\u2286";a.supe="\u2287";a.oplus="\u2295";a.otimes="\u2297";a.perp="\u22a5";a.sdot="\u22c5";a.lceil="\u2308";
a.rceil="\u2309";a.lfloor="\u230a";a.rfloor="\u230b";a.lang="\u2329";a.rang="\u232a";a.loz="\u25ca";a.spades="\u2660";a.clubs="\u2663";a.hearts="\u2665";a.diams="\u2666"})();SimileAjax.HTML.deEntify=function(a){for(var b=SimileAjax.HTML._e2uHash,c=/&(\w+?);/;c.test(a);){var d=a.match(c);a=a.replace(c,b[d[1]])}return a};SimileAjax.Set=function(a){this._hash={};this._count=0;if(a instanceof Array)for(var b=0;b<a.length;b++)this.add(a[b]);else a instanceof SimileAjax.Set&&this.addSet(a)};
SimileAjax.Set.prototype.add=function(a){return!(a in this._hash)?(this._hash[a]=!0,this._count++,!0):!1};SimileAjax.Set.prototype.addSet=function(a){for(var b in a._hash)this.add(b)};SimileAjax.Set.prototype.remove=function(a){return a in this._hash?(delete this._hash[a],this._count--,!0):!1};SimileAjax.Set.prototype.removeSet=function(a){for(var b in a._hash)this.remove(b)};SimileAjax.Set.prototype.retainSet=function(a){for(var b in this._hash)a.contains(b)||(delete this._hash[b],this._count--)};
SimileAjax.Set.prototype.contains=function(a){return a in this._hash};SimileAjax.Set.prototype.size=function(){return this._count};SimileAjax.Set.prototype.toArray=function(){var a=[],b;for(b in this._hash)a.push(b);return a};SimileAjax.Set.prototype.visit=function(a){for(var b in this._hash)if(!0==a(b))break};SimileAjax.SortedArray=function(a,b){this._a=b instanceof Array?b:[];this._compare=a};
SimileAjax.SortedArray.prototype.add=function(a){var b=this,c=this.find(function(c){return b._compare(c,a)});c<this._a.length?this._a.splice(c,0,a):this._a.push(a)};SimileAjax.SortedArray.prototype.remove=function(a){for(var b=this,c=this.find(function(c){return b._compare(c,a)});c<this._a.length&&0==this._compare(this._a[c],a);){if(this._a[c]==a)return this._a.splice(c,1),!0;c++}return!1};SimileAjax.SortedArray.prototype.removeAll=function(){this._a=[]};
SimileAjax.SortedArray.prototype.elementAt=function(a){return this._a[a]};SimileAjax.SortedArray.prototype.length=function(){return this._a.length};SimileAjax.SortedArray.prototype.find=function(a){for(var b=0,c=this._a.length;b<c;){var d=Math.floor((b+c)/2),f=a(this._a[d]);if(d==b)return 0>f?b+1:b;0>f?b=d:c=d}return b};SimileAjax.SortedArray.prototype.getFirst=function(){return 0<this._a.length?this._a[0]:null};
SimileAjax.SortedArray.prototype.getLast=function(){return 0<this._a.length?this._a[this._a.length-1]:null};SimileAjax.EventIndex=function(a){var b=this;this._unit=null!=a?a:SimileAjax.NativeDateUnit;this._events=new SimileAjax.SortedArray(function(a,d){return b._unit.compare(a.getStart(),d.getStart())});this._idToEvent={};this._indexed=!0};SimileAjax.EventIndex.prototype.getUnit=function(){return this._unit};SimileAjax.EventIndex.prototype.getEvent=function(a){return this._idToEvent[a]};
SimileAjax.EventIndex.prototype.add=function(a){this._events.add(a);this._idToEvent[a.getID()]=a;this._indexed=!1};SimileAjax.EventIndex.prototype.removeAll=function(){this._events.removeAll();this._idToEvent={};this._indexed=!1};SimileAjax.EventIndex.prototype.getCount=function(){return this._events.length()};SimileAjax.EventIndex.prototype.getIterator=function(a,b){this._indexed||this._index();return new SimileAjax.EventIndex._Iterator(this._events,a,b,this._unit)};
SimileAjax.EventIndex.prototype.getReverseIterator=function(a,b){this._indexed||this._index();return new SimileAjax.EventIndex._ReverseIterator(this._events,a,b,this._unit)};SimileAjax.EventIndex.prototype.getAllIterator=function(){return new SimileAjax.EventIndex._AllIterator(this._events)};SimileAjax.EventIndex.prototype.getEarliestDate=function(){var a=this._events.getFirst();return null==a?null:a.getStart()};
SimileAjax.EventIndex.prototype.getLatestDate=function(){var a=this._events.getLast();if(null==a)return null;this._indexed||this._index();for(var b=a._earliestOverlapIndex,a=this._events.elementAt(b).getEnd(),b=b+1;b<this._events.length();b++)a=this._unit.later(a,this._events.elementAt(b).getEnd());return a};
SimileAjax.EventIndex.prototype._index=function(){for(var a=this._events.length(),b=0;b<a;b++){var c=this._events.elementAt(b);c._earliestOverlapIndex=b}for(var d=1,b=0;b<a;b++){c=this._events.elementAt(b);c=c.getEnd();for(d=Math.max(d,b+1);d<a;){var f=this._events.elementAt(d),e=f.getStart();if(0>this._unit.compare(e,c))f._earliestOverlapIndex=b,d++;else break}}this._indexed=!0};
SimileAjax.EventIndex._Iterator=function(a,b,c,d){this._events=a;this._startDate=b;this._endDate=c;this._unit=d;this._currentIndex=a.find(function(a){return d.compare(a.getStart(),b)});0<=this._currentIndex-1&&(this._currentIndex=this._events.elementAt(this._currentIndex-1)._earliestOverlapIndex);this._currentIndex--;this._maxIndex=a.find(function(a){return d.compare(a.getStart(),c)});this._hasNext=!1;this._next=null;this._findNext()};
SimileAjax.EventIndex._Iterator.prototype={hasNext:function(){return this._hasNext},next:function(){if(this._hasNext){var a=this._next;this._findNext();return a}return null},_findNext:function(){for(var a=this._unit;++this._currentIndex<this._maxIndex;){var b=this._events.elementAt(this._currentIndex);if(0>a.compare(b.getStart(),this._endDate)&&0<a.compare(b.getEnd(),this._startDate)){this._next=b;this._hasNext=!0;return}}this._next=null;this._hasNext=!1}};
SimileAjax.EventIndex._ReverseIterator=function(a,b,c,d){this._events=a;this._startDate=b;this._endDate=c;this._unit=d;this._minIndex=a.find(function(a){return d.compare(a.getStart(),b)});0<=this._minIndex-1&&(this._minIndex=this._events.elementAt(this._minIndex-1)._earliestOverlapIndex);this._currentIndex=this._maxIndex=a.find(function(a){return d.compare(a.getStart(),c)});this._hasNext=!1;this._next=null;this._findNext()};
SimileAjax.EventIndex._ReverseIterator.prototype={hasNext:function(){return this._hasNext},next:function(){if(this._hasNext){var a=this._next;this._findNext();return a}return null},_findNext:function(){for(var a=this._unit;--this._currentIndex>=this._minIndex;){var b=this._events.elementAt(this._currentIndex);if(0>a.compare(b.getStart(),this._endDate)&&0<a.compare(b.getEnd(),this._startDate)){this._next=b;this._hasNext=!0;return}}this._next=null;this._hasNext=!1}};
SimileAjax.EventIndex._AllIterator=function(a){this._events=a;this._index=0};SimileAjax.EventIndex._AllIterator.prototype={hasNext:function(){return this._index<this._events.length()},next:function(){return this._index<this._events.length()?this._events.elementAt(this._index++):null}};SimileAjax.NativeDateUnit={};SimileAjax.NativeDateUnit.makeDefaultValue=function(){return new Date};SimileAjax.NativeDateUnit.cloneValue=function(a){return new Date(a.getTime())};
SimileAjax.NativeDateUnit.getParser=function(a){"string"==typeof a&&(a=a.toLowerCase());var b="iso8601"==a||"iso 8601"==a?SimileAjax.DateTime.parseIso8601DateTime:SimileAjax.DateTime.parseGregorianDateTime;return function(a){return"undefined"!=typeof a&&"function"==typeof a.toUTCString?a:b(a)}};SimileAjax.NativeDateUnit.parseFromObject=function(a){return SimileAjax.DateTime.parseGregorianDateTime(a)};SimileAjax.NativeDateUnit.toNumber=function(a){return a.getTime()};
SimileAjax.NativeDateUnit.fromNumber=function(a){return new Date(a)};SimileAjax.NativeDateUnit.compare=function(a,b){var c,d;c="object"==typeof a?a.getTime():Number(a);d="object"==typeof b?b.getTime():Number(b);return c-d};SimileAjax.NativeDateUnit.earlier=function(a,b){return 0>SimileAjax.NativeDateUnit.compare(a,b)?a:b};SimileAjax.NativeDateUnit.later=function(a,b){return 0<SimileAjax.NativeDateUnit.compare(a,b)?a:b};SimileAjax.NativeDateUnit.change=function(a,b){return new Date(a.getTime()+b)};
SimileAjax.ListenerQueue=function(a){this._listeners=[];this._wildcardHandlerName=a};SimileAjax.ListenerQueue.prototype.add=function(a){this._listeners.push(a)};SimileAjax.ListenerQueue.prototype.remove=function(a){for(var b=this._listeners,c=0;c<b.length;c++)if(b[c]==a){b.splice(c,1);break}};
SimileAjax.ListenerQueue.prototype.fire=function(a,b){for(var c=[].concat(this._listeners),d=0;d<c.length;d++){var f=c[d];if(a in f)try{f[a].apply(f,b)}catch(e){SimileAjax.Debug.exception("Error firing event of name "+a,e)}else if(null!=this._wildcardHandlerName&&this._wildcardHandlerName in f)try{f[this._wildcardHandlerName].apply(f,[a])}catch(h){SimileAjax.Debug.exception("Error firing event of name "+a+" to wildcard handler",h)}}};
SimileAjax.History={maxHistoryLength:10,historyFile:"__history__.html",enabled:!0,_initialized:!1,_listeners:new SimileAjax.ListenerQueue,_actions:[],_baseIndex:0,_currentIndex:0,_plainDocumentTitle:document.title};SimileAjax.History.formatHistoryEntryTitle=function(a){return SimileAjax.History._plainDocumentTitle+" {"+a+"}"};
SimileAjax.History.initialize=function(){if(!SimileAjax.History._initialized){if(SimileAjax.History.enabled){var a=document.createElement("iframe");a.id="simile-ajax-history";a.style.position="absolute";a.style.width="10px";a.style.height="10px";a.style.top="0px";a.style.left="0px";a.style.visibility="hidden";a.src=SimileAjax.History.historyFile+"?0";SimileAjax.History._iframe=a}SimileAjax.History._initialized=!0}};SimileAjax.History.addListener=function(a){SimileAjax.History.initialize();SimileAjax.History._listeners.add(a)};
SimileAjax.History.removeListener=function(a){SimileAjax.History.initialize();SimileAjax.History._listeners.remove(a)};
SimileAjax.History.addAction=function(a){SimileAjax.History.initialize();SimileAjax.History._listeners.fire("onBeforePerform",[a]);window.setTimeout(function(){try{if(a.perform(),SimileAjax.History._listeners.fire("onAfterPerform",[a]),SimileAjax.History.enabled){SimileAjax.History._actions=SimileAjax.History._actions.slice(0,SimileAjax.History._currentIndex-SimileAjax.History._baseIndex);SimileAjax.History._actions.push(a);SimileAjax.History._currentIndex++;var b=SimileAjax.History._actions.length-
SimileAjax.History.maxHistoryLength;0<b&&(SimileAjax.History._actions=SimileAjax.History._actions.slice(b),SimileAjax.History._baseIndex+=b);try{SimileAjax.History._iframe.contentWindow.location.search="?"+SimileAjax.History._currentIndex}catch(c){var d=SimileAjax.History.formatHistoryEntryTitle(a.label);document.title=d}}}catch(f){SimileAjax.Debug.exception(f,"Error adding action {"+a.label+"} to history")}},0)};
SimileAjax.History.addLengthyAction=function(a,b,c){SimileAjax.History.addAction({perform:a,undo:b,label:c,uiLayer:SimileAjax.WindowManager.getBaseLayer(),lengthy:!0})};
SimileAjax.History._handleIFrameOnLoad=function(){try{var a=SimileAjax.History._iframe.contentWindow.location.search,b=0==a.length?0:Math.max(0,parseInt(a.substr(1))),c=function(){var a=b-SimileAjax.History._currentIndex;SimileAjax.History._currentIndex+=a;SimileAjax.History._baseIndex+=a;SimileAjax.History._iframe.contentWindow.location.search="?"+b};if(b<SimileAjax.History._currentIndex)SimileAjax.History._listeners.fire("onBeforeUndoSeveral",[]),window.setTimeout(function(){for(;SimileAjax.History._currentIndex>
b&&SimileAjax.History._currentIndex>SimileAjax.History._baseIndex;){SimileAjax.History._currentIndex--;var a=SimileAjax.History._actions[SimileAjax.History._currentIndex-SimileAjax.History._baseIndex];try{a.undo()}catch(d){SimileAjax.Debug.exception(d,"History: Failed to undo action {"+a.label+"}")}}SimileAjax.History._listeners.fire("onAfterUndoSeveral",[]);c()},0);else if(b>SimileAjax.History._currentIndex)SimileAjax.History._listeners.fire("onBeforeRedoSeveral",[]),window.setTimeout(function(){for(;SimileAjax.History._currentIndex<
b&&SimileAjax.History._currentIndex-SimileAjax.History._baseIndex<SimileAjax.History._actions.length;){var a=SimileAjax.History._actions[SimileAjax.History._currentIndex-SimileAjax.History._baseIndex];try{a.perform()}catch(d){SimileAjax.Debug.exception(d,"History: Failed to redo action {"+a.label+"}")}SimileAjax.History._currentIndex++}SimileAjax.History._listeners.fire("onAfterRedoSeveral",[]);c()},0);else{var d=SimileAjax.History._currentIndex-SimileAjax.History._baseIndex-1,f=0<=d&&d<SimileAjax.History._actions.length?
SimileAjax.History.formatHistoryEntryTitle(SimileAjax.History._actions[d].label):SimileAjax.History._plainDocumentTitle;SimileAjax.History._iframe.contentWindow.document.title=f;document.title=f}}catch(e){}};SimileAjax.History.getNextUndoAction=function(){try{return SimileAjax.History._actions[SimileAjax.History._currentIndex-SimileAjax.History._baseIndex-1]}catch(a){return null}};
SimileAjax.History.getNextRedoAction=function(){try{return SimileAjax.History._actions[SimileAjax.History._currentIndex-SimileAjax.History._baseIndex]}catch(a){return null}};SimileAjax.WindowManager={_initialized:!1,_listeners:[],_draggedElement:null,_draggedElementCallback:null,_dropTargetHighlightElement:null,_lastCoords:null,_ghostCoords:null,_draggingMode:"",_dragging:!1,_layers:[]};
SimileAjax.WindowManager.initialize=function(){SimileAjax.WindowManager._initialized||(SimileAjax.DOM.registerEvent(document.body,"mousedown",SimileAjax.WindowManager._onBodyMouseDown),SimileAjax.DOM.registerEvent(document.body,"mousemove",SimileAjax.WindowManager._onBodyMouseMove),SimileAjax.DOM.registerEvent(document.body,"mouseup",SimileAjax.WindowManager._onBodyMouseUp),SimileAjax.DOM.registerEvent(document,"keydown",SimileAjax.WindowManager._onBodyKeyDown),SimileAjax.DOM.registerEvent(document,
"keyup",SimileAjax.WindowManager._onBodyKeyUp),SimileAjax.WindowManager._layers.push({index:0}),SimileAjax.WindowManager._historyListener={onBeforeUndoSeveral:function(){},onAfterUndoSeveral:function(){},onBeforeUndo:function(){},onAfterUndo:function(){},onBeforeRedoSeveral:function(){},onAfterRedoSeveral:function(){},onBeforeRedo:function(){},onAfterRedo:function(){}},SimileAjax.History.addListener(SimileAjax.WindowManager._historyListener),SimileAjax.WindowManager._initialized=!0)};
SimileAjax.WindowManager.getBaseLayer=function(){SimileAjax.WindowManager.initialize();return SimileAjax.WindowManager._layers[0]};SimileAjax.WindowManager.getHighestLayer=function(){SimileAjax.WindowManager.initialize();return SimileAjax.WindowManager._layers[SimileAjax.WindowManager._layers.length-1]};SimileAjax.WindowManager.registerEventWithObject=function(a,b,c,d,f){SimileAjax.WindowManager.registerEvent(a,b,function(a,b,f){return c[d].call(c,a,b,f)},f)};
SimileAjax.WindowManager.registerEvent=function(a,b,c,d){null==d&&(d=SimileAjax.WindowManager.getHighestLayer());SimileAjax.DOM.registerEvent(a,b,function(a,b,h){if(SimileAjax.WindowManager._canProcessEventAtLayer(d)){SimileAjax.WindowManager._popToLayer(d.index);try{c(a,b,h)}catch(g){SimileAjax.Debug.exception(g)}}SimileAjax.DOM.cancelEvent(b);return!1})};
SimileAjax.WindowManager.pushLayer=function(a,b,c){a={onPop:a,index:SimileAjax.WindowManager._layers.length,ephemeral:b,elmt:c};SimileAjax.WindowManager._layers.push(a);return a};SimileAjax.WindowManager.popLayer=function(a){for(var b=1;b<SimileAjax.WindowManager._layers.length;b++)if(SimileAjax.WindowManager._layers[b]==a){SimileAjax.WindowManager._popToLayer(b-1);break}};SimileAjax.WindowManager.popAllLayers=function(){SimileAjax.WindowManager._popToLayer(0)};
SimileAjax.WindowManager.registerForDragging=function(a,b,c){SimileAjax.WindowManager.registerEvent(a,"mousedown",function(a,c){SimileAjax.WindowManager._handleMouseDown(a,c,b)},c)};SimileAjax.WindowManager._popToLayer=function(a){for(;a+1<SimileAjax.WindowManager._layers.length;)try{var b=SimileAjax.WindowManager._layers.pop();if(null!=b.onPop)b.onPop()}catch(c){}};
SimileAjax.WindowManager._canProcessEventAtLayer=function(a){if(a.index==SimileAjax.WindowManager._layers.length-1)return!0;for(a=a.index+1;a<SimileAjax.WindowManager._layers.length;a++)if(!SimileAjax.WindowManager._layers[a].ephemeral)return!1;return!0};
SimileAjax.WindowManager.cancelPopups=function(a){a=a?SimileAjax.DOM.getEventPageCoordinates(a):{x:-1,y:-1};for(var b=SimileAjax.WindowManager._layers.length-1;0<b&&SimileAjax.WindowManager._layers[b].ephemeral;){var c=SimileAjax.WindowManager._layers[b];if(null!=c.elmt){var c=c.elmt,d=SimileAjax.DOM.getPageCoordinates(c);if(a.x>=d.left&&a.x<d.left+c.offsetWidth&&a.y>=d.top&&a.y<d.top+c.offsetHeight)break}b--}SimileAjax.WindowManager._popToLayer(b)};
SimileAjax.WindowManager._onBodyMouseDown=function(a,b){(!("eventPhase"in b)||b.eventPhase==b.BUBBLING_PHASE)&&SimileAjax.WindowManager.cancelPopups(b)};SimileAjax.WindowManager._handleMouseDown=function(a,b,c){SimileAjax.WindowManager._draggedElement=a;SimileAjax.WindowManager._draggedElementCallback=c;SimileAjax.WindowManager._lastCoords={x:b.clientX,y:b.clientY};SimileAjax.DOM.cancelEvent(b);return!1};
SimileAjax.WindowManager._onBodyKeyDown=function(a,b){if(SimileAjax.WindowManager._dragging)if(27==b.keyCode)SimileAjax.WindowManager._cancelDragging();else if((17==b.keyCode||16==b.keyCode)&&"copy"!=SimileAjax.WindowManager._draggingMode){SimileAjax.WindowManager._draggingMode="copy";var c=SimileAjax.Graphics.createTranslucentImage(SimileAjax.urlPrefix+"images/copy.png");c.style.position="absolute";c.style.left=SimileAjax.WindowManager._ghostCoords.left-16+"px";c.style.top=SimileAjax.WindowManager._ghostCoords.top+
"px";document.body.appendChild(c);SimileAjax.WindowManager._draggingModeIndicatorElmt=c}};SimileAjax.WindowManager._onBodyKeyUp=function(a,b){if(SimileAjax.WindowManager._dragging&&(17==b.keyCode||16==b.keyCode))SimileAjax.WindowManager._draggingMode="",null!=SimileAjax.WindowManager._draggingModeIndicatorElmt&&(document.body.removeChild(SimileAjax.WindowManager._draggingModeIndicatorElmt),SimileAjax.WindowManager._draggingModeIndicatorElmt=null)};
SimileAjax.WindowManager._onBodyMouseMove=function(a,b,c){if(null!=SimileAjax.WindowManager._draggedElement){a=SimileAjax.WindowManager._draggedElementCallback;var d=SimileAjax.WindowManager._lastCoords,f=b.clientX-d.x,d=b.clientY-d.y;if(SimileAjax.WindowManager._dragging)try{SimileAjax.WindowManager._lastCoords={x:b.clientX,y:b.clientY};if("onDragBy"in a)a.onDragBy(f,d);if("_ghostElmt"in a){p=a._ghostElmt;SimileAjax.WindowManager._ghostCoords.left+=f;SimileAjax.WindowManager._ghostCoords.top+=d;
p.style.left=SimileAjax.WindowManager._ghostCoords.left+"px";p.style.top=SimileAjax.WindowManager._ghostCoords.top+"px";if(null!=SimileAjax.WindowManager._draggingModeIndicatorElmt){var e=SimileAjax.WindowManager._draggingModeIndicatorElmt;e.style.left=SimileAjax.WindowManager._ghostCoords.left-16+"px";e.style.top=SimileAjax.WindowManager._ghostCoords.top+"px"}if("droppable"in a&&a.droppable){var h=SimileAjax.DOM.getEventPageCoordinates(b);c=SimileAjax.DOM.hittest(h.x,h.y,[SimileAjax.WindowManager._ghostElmt,
SimileAjax.WindowManager._dropTargetHighlightElement]);c=SimileAjax.WindowManager._findDropTarget(c);if(c!=SimileAjax.WindowManager._potentialDropTarget){null!=SimileAjax.WindowManager._dropTargetHighlightElement&&(document.body.removeChild(SimileAjax.WindowManager._dropTargetHighlightElement),SimileAjax.WindowManager._dropTargetHighlightElement=null,SimileAjax.WindowManager._potentialDropTarget=null);e=!1;if(null!=c&&(!("canDropOn"in a)||a.canDropOn(c))&&(!("canDrop"in c)||c.canDrop(SimileAjax.WindowManager._draggedElement)))e=
!0;if(e){var g=SimileAjax.DOM.getPageCoordinates(c),j=document.createElement("div");j.style.border="4px solid yellow";j.style.backgroundColor="yellow";j.style.position="absolute";j.style.left=g.left+"px";j.style.top=g.top+"px";j.style.width=c.offsetWidth-8+"px";j.style.height=c.offsetHeight-8+"px";SimileAjax.Graphics.setOpacity(j,30);document.body.appendChild(j);SimileAjax.WindowManager._potentialDropTarget=c;SimileAjax.WindowManager._dropTargetHighlightElement=j}}}}}catch(l){SimileAjax.Debug.exception("WindowManager: Error handling mouse move",
l),SimileAjax.WindowManager._cancelDragging()}else if(5<Math.abs(f)||5<Math.abs(d))try{if("onDragStart"in a)a.onDragStart();if("ghost"in a&&a.ghost){var m=SimileAjax.WindowManager._draggedElement;SimileAjax.WindowManager._ghostCoords=SimileAjax.DOM.getPageCoordinates(m);SimileAjax.WindowManager._ghostCoords.left+=f;SimileAjax.WindowManager._ghostCoords.top+=d;var p=m.cloneNode(!0);p.style.position="absolute";p.style.left=SimileAjax.WindowManager._ghostCoords.left+"px";p.style.top=SimileAjax.WindowManager._ghostCoords.top+
"px";p.style.zIndex=1E3;SimileAjax.Graphics.setOpacity(p,50);document.body.appendChild(p);a._ghostElmt=p}SimileAjax.WindowManager._dragging=!0;SimileAjax.WindowManager._lastCoords={x:b.clientX,y:b.clientY};document.body.focus()}catch(k){SimileAjax.Debug.exception("WindowManager: Error handling mouse down",k),SimileAjax.WindowManager._cancelDragging()}SimileAjax.DOM.cancelEvent(b);return!1}};
SimileAjax.WindowManager._onBodyMouseUp=function(a,b,c){if(null!=SimileAjax.WindowManager._draggedElement){try{if(SimileAjax.WindowManager._dragging){var d=SimileAjax.WindowManager._draggedElementCallback;if("onDragEnd"in d)d.onDragEnd();if("droppable"in d&&d.droppable&&(c=SimileAjax.WindowManager._potentialDropTarget,null!=c&&(!("canDropOn"in d)||d.canDropOn(c))&&(!("canDrop"in c)||c.canDrop(SimileAjax.WindowManager._draggedElement)))){if("onDropOn"in d)d.onDropOn(c);c.ondrop(SimileAjax.WindowManager._draggedElement,
SimileAjax.WindowManager._draggingMode)}}}finally{SimileAjax.WindowManager._cancelDragging()}SimileAjax.DOM.cancelEvent(b);return!1}};
SimileAjax.WindowManager._cancelDragging=function(){var a=SimileAjax.WindowManager._draggedElementCallback;"_ghostElmt"in a&&(document.body.removeChild(a._ghostElmt),delete a._ghostElmt);null!=SimileAjax.WindowManager._dropTargetHighlightElement&&(document.body.removeChild(SimileAjax.WindowManager._dropTargetHighlightElement),SimileAjax.WindowManager._dropTargetHighlightElement=null);null!=SimileAjax.WindowManager._draggingModeIndicatorElmt&&(document.body.removeChild(SimileAjax.WindowManager._draggingModeIndicatorElmt),
SimileAjax.WindowManager._draggingModeIndicatorElmt=null);SimileAjax.WindowManager._draggedElement=null;SimileAjax.WindowManager._draggedElementCallback=null;SimileAjax.WindowManager._potentialDropTarget=null;SimileAjax.WindowManager._dropTargetHighlightElement=null;SimileAjax.WindowManager._lastCoords=null;SimileAjax.WindowManager._ghostCoords=null;SimileAjax.WindowManager._draggingMode="";SimileAjax.WindowManager._dragging=!1};
SimileAjax.WindowManager._findDropTarget=function(a){for(;null!=a&&!("ondrop"in a&&"function"==typeof a.ondrop);)a=a.parentNode;return a};
